<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/designTemplate.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<style type="text/css">
  .centeredImage
    {
    text-align:center;
    margin-top:0px;
    margin-bottom:0px;
    padding:0px;
    }
</style>


<meta name="description" content="Let's talk about Rest API and try to create a simple API with python and flask"/>


<meta name="keywords" content="API, patterns, software, architecture, design, engineering, science, computer, REST, RESTful, python"/>


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<!-- InstanceBeginEditable name="doctitle" -->
<title>Rodrigo Araújo ::: Software Engineer / Computer Scientist</title>


<!-- InstanceEndEditable -->

<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href="../../../../../css/stylesheet.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="../../../../../css/styles/github.css">
<script src="../../../../../highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script><!--[if IE]>

<style type="text/css"> 
/* place css fixes for all versions of IE in this conditional comment */
.twoColHybRtHdr #sidebar1 { padding-top: 30px; }
.twoColHybRtHdr #mainContent { zoom: 1; padding-top: 15px; }
/* the above proprietary zoom property gives IE the hasLayout it may need to avoid several bugs */
</style>
<![endif]-->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

</head>

<body class="twoColHybRtHdr">
        <div class="sidebar" style="height:100%;">
<div id="container"><!-- InstanceBeginEditable name="headerNav" -->
  <div id="header" style='margin-top:-55px; padding-top:25px;'>
    
      <tr>
        <h1><a href="../../../../../index.html">Rodrigo Araújo</a></h1>
      </tr>
        <h4>Software Engineer & Computer Scientist</h4>

    
    <tr>
    </tr>
    <tr>
      <h3 style="padding-top:10px; margin-left:2px;">
        <!--<a href="./HomePage.html"><img src="./images/back.png" width="15"></a>
              <tr>
        <td>&nbsp;</td>
      </tr><-->

        <a href="/blog/" onclick="">BLOG    &nbsp;&nbsp;</a> 
        <a href="/about/">ABOUT    &nbsp;&nbsp;</a>
        <a href="/work/">WORK    &nbsp;&nbsp;</a>
        <a href="/contact/">CONTACT    &nbsp;&nbsp;</a>
      </h3>
    </tr>
    
    <!-- end #header -->
  </div>
  <div style="width:390px; margin-top:0px;" id="sidebar">
       <ul style="padding-top: 18px;">
               <hr/>
          <li style="font-size:22px;"><a href="/archives/">Archives</a></li>
          <hr/>
      </ul>
</div> 

  <div style="margin-left:235px;margin-top:-128px;" id="mainContent" class="hidden">
          <h1> <div style="margin-top:-10px;line-height:1.2em;">Web Scaling: Using Redis as Cache </div></h1>
          <div style="margin-top:-20px;color:#E11F00;">25 May 2015</div>
          &nbsp;
    <style>
.hljs{
        font-size:12px;
}
</style>
<html>
        <p><strong>Redis is such a great technology.</strong> Unfortunately, there's still people who doesn't know Redis or doesn't know that Redis can be used as a Cache System to improve the speed of responses. </p>
&nbsp;

<p><h2>Why Redis</strong></h2>

<p>Well, let's start this discussion remembering how a common Relational Database basically works: Suppose we're using a MySQL, every time your app sends a request to the MySQL client, the MySQL client gotta make a trip to the hard drive to get the data asked in the request, this can become a problem if the data asked in request is big... and if there are many requests at the same time, this can generate a huge latency, annoying users or worse. </p>

<p>This is where Redis comes into play, Redis is a key-value database that will be running and storing data inside your memory, if you remember the basic of computers architecture: </p>
<img src="/images/memchart.jpg">


<p>It's way faster to access data in memory (Physical RAM, main memory) than to access data in the Hard Drive, so it's easy to notice that if the data that the application wants to access is inside the main memory, it's way easier to reach to that data than if it was stored in the Hard Drive.</p>

<p>So, like I said, Redis will be storing its data inside the memory, but you may ask yourself: "but what if I turn off the machine?? isn't the ram memory volatile? " Yes, that's why Redis will be flushing the data to the hard drive from time to time, it's up to you to choose this time between flushes, it's all about Performance vs. Security.</p>

<p>So, What we'll be doing is just:</p>
<div align="center">

<div class="sequence-diagram"><svg height="528" version="1.1" width="355.875" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow: hidden; position: relative;"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with RaphaÃ«l 2.1.2</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><marker id="raphael-marker-endblock55-obj1776" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj1781" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj1784" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj1787" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj1792" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj1795" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj1798" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj1801" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj1804" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj1807" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker></defs><rect x="10" y="20" width="44.8125" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="30" width="24.8125" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="32.40625" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">App</tspan></text><rect x="10" y="469" width="44.8125" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="479" width="24.8125" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="32.40625" y="488.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">App</tspan></text><path fill="none" stroke="#000000" d="M32.40625,59L32.40625,469" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="108.328125" y="20" width="54.46875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="118.328125" y="30" width="34.46875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="135.5625" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Redis</tspan></text><rect x="108.328125" y="469" width="54.46875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="118.328125" y="479" width="34.46875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="135.5625" y="488.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Redis</tspan></text><path fill="none" stroke="#000000" d="M135.5625,59L135.5625,469" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="262.6875" y="20" width="63.1875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="272.6875" y="30" width="43.1875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="294.28125" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">MySQL</tspan></text><rect x="262.6875" y="469" width="63.1875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="272.6875" y="479" width="43.1875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="294.28125" y="488.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">MySQL</tspan></text><path fill="none" stroke="#000000" d="M294.28125,59L294.28125,469" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="42.40625" y="74.5" width="83.15625" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="83.984375" y="84" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Request data</tspan></text><path fill="none" stroke="#000000" d="M32.40625,98C32.40625,98,109.93753726221621,98,130.5696425151009,98" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj1776)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="160.5625" y="118" width="82.96875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="202.046875" y="127.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">No key found</tspan></text><path fill="none" stroke="#000000" d="M135.5625,113L155.5625,113" stroke-width="2" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><path fill="none" stroke="#000000" d="M155.5625,113L155.5625,147" stroke-width="2" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><path fill="none" stroke="#000000" d="M155.5625,147C155.5625,147,146.4816131591797,147,140.5577533841133,147" stroke-width="2" stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj1781)" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="173.34375" y="152.5" width="83.15625" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="214.921875" y="162" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Request data</tspan></text><path fill="none" stroke="#000000" d="M135.5625,176C135.5625,176,262.3245228412561,176,289.2800213507127,176" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj1784)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="177.625" y="191.5" width="74.59375" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="214.921875" y="201" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Return data</tspan></text><path fill="none" stroke="#000000" d="M294.28125,215C294.28125,215,167.5192271587439,215,140.56372864928733,215" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj1787)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="160.5625" y="235" width="118.71875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="219.921875" y="244.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">set data into cache</tspan></text><path fill="none" stroke="#000000" d="M135.5625,230L155.5625,230" stroke-width="2" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><path fill="none" stroke="#000000" d="M155.5625,230L155.5625,264" stroke-width="2" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><path fill="none" stroke="#000000" d="M155.5625,264C155.5625,264,146.4816131591797,264,140.5577533841133,264" stroke-width="2" stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj1792)" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="48.4375" y="269.5" width="71.09375" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="83.984375" y="279" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">return data</tspan></text><path fill="none" stroke="#000000" d="M135.5625,293C135.5625,293,58.03121273778379,293,37.399107484899105,293" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj1795)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="42.40625" y="308.5" width="83.15625" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="83.984375" y="318" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Request data</tspan></text><path fill="none" stroke="#000000" d="M32.40625,332C32.40625,332,109.93753726221621,332,130.5696425151009,332" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj1798)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="48.4375" y="347.5" width="71.09375" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="83.984375" y="357" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">return data</tspan></text><path fill="none" stroke="#000000" d="M135.5625,371C135.5625,371,58.03121273778379,371,37.399107484899105,371" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj1801)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="42.40625" y="386.5" width="83.15625" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="83.984375" y="396" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Request data</tspan></text><path fill="none" stroke="#000000" d="M32.40625,410C32.40625,410,109.93753726221621,410,130.5696425151009,410" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj1804)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="48.4375" y="425.5" width="71.09375" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="83.984375" y="435" text-anchor="middle" font-family="Andale Mono, monospace" font-size="13px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 13px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">return data</tspan></text><path fill="none" stroke="#000000" d="M135.5625,449C135.5625,449,58.03121273778379,449,37.399107484899105,449" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj1807)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path></svg></div>
</div>

<p><strong>As you can see: So much win. We avoided redundant trips to the disk.</p></strong>
<p>Now that we understand the concept of what we'll be doing, the code becomes very easy to implement, here's a simple idea <em>(thougt it can be improved and extended in many ways, but it can demonstrate the idea we're working here)</em></p>

<pre>
<code class="python hljs"> 
from flask import Flask
from flask.ext.sqlalchemy import SQLAlchemy
from sqlalchemy import create_engine
import redis

app = Flask(__name__)
url = 'mysql+pymysql://username:password@ip/dbname'
app.config['SQLALCHEMY_DATABASE_URI'] = url
db = SQLAlchemy(app)
cache = redis.StrictRedis(host='localhost', port=6379, db=0)

#improvement: model could stay in a different file
class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80))
    email = db.Column(db.String(120))

    def __init__(self, username, email):
        self.username = username
        self.email = email

    def __repr__(self):
        return '<User %r>' % self.username

def createUsers():
        for x in xrange(0,100000):
            user = User('test', 'test')
            db.session.add(user)
        db.session.commit()

def getUsers():
        users = cache.get('users')
        if not users:
            users = User.query.all()
            cache.set('users', users)

# improvement: views/routing should stay in a different file
@app.route('/')
def hello_world():
    getUsers()
    return 'Hello Worldd!'

if __name__ == '__main__':
    app.debug=True
    app.run(host='0.0.0.0')

</code>
</pre>

<p>So, after you create the correct database, populate the database (there's a function in the code for that) and change username/password/dbname in the code, we'll run the app.py and go to localhost:port-you-exposed.</p>
&nbsp;

<h2><em>What will happen?</em></h2>

<p>1. The first time you access it, it will take a few seconds to get the data from the MySQL</p>
<p>2. The second time you access it, it will take just a few milliseconds to get the same data from redis</p>

<p>In my computer the result was:</p>
<p>first access: 45861 milliseconds</p>
<p>second access: 5ms</p>

<strong><p>I know, right? That's just blazing fast!</p></strong>

<p>And it can save a lot of computational resources and human time. Now, with this logic applied to one method (the method to get users), we can apply it to whichever method we want, or we can even create a generic decorator and annotate the methods that we want do the caching!! </p>





</html>



&nbsp;
    <hr/>
    <p> <em>Thanks for reading!</em>
   <a href="https://twitter.com/intent/tweet?url=http://rodrigoaraujo.me/2015/05/25/Scaling-Python:-Using-Redis-as-Cache/&text=Web Scaling: Using Redis as Cache&via=digorithm" 
             target="_blank">
            Share it on Twitter</a> 
  or 
  <a href="https://twitter.com/digorithm" target="_blank">
           follow me on Twitter</a>!
   </p>
<hr/>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    // Required: on line below, replace text in quotes with your forum shortname
    var disqus_shortname = 'rodrigoaraujo';
        
        /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                                        
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



  </div>
  </div>

<!-- InstanceEndEditable --><!-- InstanceBeginEditable name="subNav" --><!-- InstanceEndEditable --><!-- InstanceBeginEditable name="mainContent" --><!-- InstanceEndEditable -->
  <!-- This clearing element should immediately follow the #mainContent div in order to force the #container div to contain all child floats -->
  <br class="clearfloat" />
  <!-- InstanceBeginEditable name="footer" -->
  <div id="footer">
    <!-- end #footer -->
    </div>
  <!-- InstanceEndEditable -->
  <!-- end #container --></div>
    

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


</body>

<script>

var fixmeTop = $('#sidebar').offset().top;       // get initial position of the element

$(window).scroll(function() {                  // assign scroll event listener

    var currentScroll = $(window).scrollTop(); // get current position

    if (currentScroll >= fixmeTop) {           // apply position: fixed if you
        $('#sidebar').css({                      // scroll to that element or below it
            position: 'fixed',
            top: '0',
	    'margin-top':'0',
            //left: '0'
        });
    } else {                                   // apply position: static
        $('#sidebar').css({                      // if you scroll above it
            position: 'static',
            'margin-top': '0px'
        });
    }

});


$(document).ready(function(){
    // to fade in on page load
   $("#mainContent").fadeIn(1500).removeClass("hidden");
   $('a').click(function(e){
        redirect = $(this).attr('href');
        e.preventDefault();
        $('#mainContent').fadeOut(500, function(){
            document.location.href = redirect
        });
    });
})

</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38327934-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- InstanceEnd --></html>
