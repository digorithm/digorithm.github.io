
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/designTemplate.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<style type="text/css">
  .centeredImage
    {
    text-align:center;
    margin-top:0px;
    margin-bottom:0px;
    padding:0px;
    }
</style>

<meta name="keywords" content="">

<meta name="description" content="">

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<!-- InstanceBeginEditable name="doctitle" -->
<title>Rodrigo Araújo ::: Software Engineer / Computer Scientist</title>


<!-- InstanceEndEditable -->

<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href="../../../../../css/stylesheet.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="../../../../../css/styles/github.css">
<script src="../../../../../highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script><!--[if IE]>

<style type="text/css"> 
/* place css fixes for all versions of IE in this conditional comment */
.twoColHybRtHdr #sidebar1 { padding-top: 30px; }
.twoColHybRtHdr #mainContent { zoom: 1; padding-top: 15px; }
/* the above proprietary zoom property gives IE the hasLayout it may need to avoid several bugs */
</style>
<![endif]-->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

</head>

<body class="twoColHybRtHdr">
        <div class="sidebar" style="height:100%;">
<div id="container"><!-- InstanceBeginEditable name="headerNav" -->
  <div id="header" style='margin-top:-30px;padding-bottom:25px;'>
    
      <tr>
        <h1><a href="../../../../../index.html">Rodrigo Araújo</a></h1>
      </tr>
        <h4>Software Engineer & Computer Scientist</h4>

    
    <tr>
    </tr>
    <tr>
      <h3 style="padding-top:10px; margin-left:2px;">
        <!--<a href="./HomePage.html"><img src="./images/back.png" width="15"></a>
              <tr>
        <td>&nbsp;</td>
      </tr><-->

        <a href="/blog/" onclick="">BLOG    &nbsp;&nbsp;</a> 
        <a href="/about/">ABOUT    &nbsp;&nbsp;</a>
        <a href="/work/">WORK    &nbsp;&nbsp;</a>
        <a href="/contact/">CONTACT    &nbsp;&nbsp;</a>
      </h3>
    </tr>
    
    <!-- end #header -->
  </div>
  
  <div style="width:390px; margin-top:0px;" id="sidebar">
       <ul>
               <hr/>
          <li style="font-size:22px;"><a href="/archives/">Archives</a></li>
          <hr/>
      </ul>
</div>  

  <div style="margin-left:180px;margin-top:-158px;" id="mainContent" class="hidden">
    
    <ul>
  
    <li>
	<h1>
      <a href="/2014/10/10/Fun-with-graphs-pt1/">
	
	<div style="line-height:35px;color:#444;">Fun with graphs pt1</div>
	
	</a>
	</h1>
	<div style="margin-top:-15px;color:#E11F00;">10 October 2014</div>
        &nbsp;
      <p><html>

<p>Graph Theory is definitely one of my favorite branches of the Mathematics & Computer Science, mostly because of its nearest infinity applications, in both real world problems and pure theoretical problems.</p>

<p>These days I’ve been working (with my buddy Daniel Almeida) in a framework to create and manipulate graphs. Which means, creating a data structure to represent graphs, edges, vertexes and creating algorithms to work on this structure. All this is being made with Java and I’ll expose this code here, as I saw a terrible lack of good readable codes about it on the internet.</p>

<p>So, before we start coding the graph’s structure… we must clarify what a graph is and why it’s so important to the Computer Science (and many other sciences).</p>

<p>
A graph is a ordered pair \(G = (V,E)\) , where \(V\) is a set of Vertices/Nodes and \(E\) is a set of Edges, an extremely mple example of a complete <a href="http://mathworld.wolfram.com/SimpleGraph.html">simple</a>, <a href="http://mathworld.wolfram.com/ConnectedGraph.html">connected</a> and <a href="http://mathworld.wolfram.com/CompleteGraph.html">complete</a> graph is:</p>
<div align="middle">
<img src="/images/graph1.png" width=119 height=259/>

<p><em>So, what’s the huge deal with this graph theory thing?</em></p>
</div>

<p>Well, not only theoretical computer science problems lay on the graph theory but also in many other distinct fields, from particle physics, chemistry to <a href="http://en.wikipedia.org/wiki/Mathematical_sociology">sociology</a>.</p>

<p>All this because every little thing in our universe is linked, and when this set of things became a “web of things”, we need to study its properties. And that’s where graph theory get in.</p>

<p>So when a graph gets bigger, we need to represent this structure in a computational way, so we can compute things like shortest path between two nodes, connectivity and thousand of other properties and techniques.</p>

<p>The most common ways to represent graph mathematically are:</p>
&nbsp;
<h2>Adjacency Matrix</h2>

<p>It’s a matrix that represent the adjacency of every node in a graph, it’s an excellent way to work computationally with graphs. The same graph that I presented previously in a visual way can be represented by the following adjacency matrix:</p>
<p>$$ 
\begin{bmatrix}
0 & 1 & 1\\ 
1 & 0 & 1\\ 
1 & 1 & 0
\end{bmatrix}
$$ 
</p>
&nbsp;
<h2>Adjacency List</h2>

<p>This is another common way to represent graph mathematically, it’s a simple list of lists, each node in the main list points to a list of their adjacent nodes.</p>

<p>Here’s an example:</p>
<img src="/images/graph2.png" width=119 height=259/>
<img src="/images/adjaceny-list.gif" style="padding-left:50px; padding-bottom:50px;" width=272 height=132/>

&nbsp;
&nbsp;
&nbsp;

<h2>Data Structures to represent Graphs</h2>

<p>Ok, so, how do we represent graphs, edges and vertexes in terms of data structures? Before we dig deeper in the algorithms and the mathematical properties of the graphs, we need to create our Data Structure to work with.</p>

<h3>The vertex</h3>

<pre>
<code class="java hljs">
package GraphModels;

public class Vertex {
    /* This Data Structure will be capable to represent a Vertex,
    * which is a Node that will be used on a graph
    */
    
    public String id;
    public String name;
    public boolean visited = false;
    
    public Vertex(String id, String name) {
        this.id = id;
        this.name = name;
    }
    public String getId() {
        return id;
    }
    
    public String getName() {
        return name;
    }
    
  @Override
  public String toString() {
    return name;
  }
    
}

</code>
</pre>

<p>For now you may be asking yourself why do we need a variable called “Visited”. Well, we’ll be using it in algorithms to walk through the graph, so we must need to know which nodes were visited. It will became more clear soon!</p>

&nbsp;

<h3>The Edge</h3>

<p>Yes, the edge must be represented computationally! That’s our way to figure out paths through the vertexes, the edge may or may not have a weight, the edge must know its source vertex and its destination vertex</p>

<pre>
<code>
package GraphModels;

public class Edge {
    
     /* This Data Structure will be capable to represent a Edge,
    *    that will be used on a graph
    */
    
    public String id;
    public Vertex source;
    public Vertex destination;
    private final int weight;
    
    public Edge(String id, Vertex source, Vertex destination, int weight) {
        this.id = id;
        this.source = source;
        this.destination = destination;
        this.weight = weight;
    }
    
    public String getId() {
        return id;
    }
    public Vertex getDestination() {
        return destination;
    }
    
    public Vertex getSource() {
        return source;
    }
    public int getWeight() {
        return weight;
    }
    
    @Override
    public String toString() {
        return source + " " + destination;
    }
} 
</code>
</pre>

&nbsp;

<h3>The Graph</h3>

<p>That’s for sure the biggest and most complex part, don’t panic with the many algorithms already implemented in this code. I’ll be explaining one by one.</p>

<p>We’re reading a text file containing the text file, if you want to test by yourself, make sure to create a .txt in the correct way and to pass the correct file path! You can find the instructions to write the .txt graph in the comments of this code</p>


<pre>
<code class="java hljs">

package GraphModels;

import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;
import java.util.Queue;

public class Graph {
    
    /* This Data Structure will be capable to represent a Graph,
    *   where G = (V, E)
    */
    
   private  List<Vertex> nodes;
   private  List<Edge> edges;
   public Vertex node;
   public Edge edge;
   private String path;
   private int [][] adjacencyMatrix;
   private Map nodesMatrixMap;
   private List<Vertex> adjacentNodes;
   public int degree;
   public int minDegree;
   public int maxDegree;
   public int avgDegree;
   

   public Graph() {
    
  }


  public List<Vertex> getNodes() {
    return nodes;
  }

  public List<Edge> getEdges() {
    return edges;
  }
  
  public void setNodes(List<Vertex> vertex){
      this.nodes = vertex;
  }
  
  public void setEdges(List<Edge> edges){
      this.edges = edges;
  }
  
  // Find an edge
  // TO-DO: Change == to equals
  public Edge getEdge(Vertex source, Vertex destination) {
      for (Edge edge : this.getEdges()) {
          if ((edge.getSource().getId() == source.getId() && edge.getDestination().getId() == destination.getId()) || (edge.getSource().getId() == destination.getId() && edge.getDestination().getId() == source.getId())) {
              return edge;
          }
      }
      return null;
  }
 
  // Check if there is an edge for two given vertices
  public boolean hasEdge(Vertex source, Vertex destination) {
      Edge result = this.getEdge(source, destination);
      if (result != null) {
        return true;
      } else {
        return false;
      }
  }
  
  public List<Vertex> getAdjacentNodes(Vertex node){
      adjacentNodes = new ArrayList<Vertex>();
      
      for (Vertex currentNode : nodes){
          if (hasEdge(node, currentNode)){
              adjacentNodes.add(currentNode);
          }
      }
       
      return adjacentNodes;
  }
  
  public int getMinDegree(){
      minDegree = 99999999;
      
      for (Vertex node : nodes){
          if (this.getDegree(node)<minDegree){
              minDegree = this.getDegree(node);
          }
      }
      
      
      return minDegree;
  }
  public int getMaxDegree(){
      maxDegree = 0;
      
      for (Vertex node : nodes){
          if (this.getDegree(node)>maxDegree){
              maxDegree = this.getDegree(node);
          }
      }

      return maxDegree;
  }
  public int getAvgDegree(){
      avgDegree = 0;
      
      for (Vertex node : nodes){
          avgDegree += this.getDegree(node);
      }
      avgDegree = avgDegree/nodes.size();
      
      return avgDegree;
  }
  
 
  //modified for our needs   
  public int breadthFirstSearch(Vertex rootNode){
      
      int visitedNodes = 0;
      Queue q = new LinkedList();
      q.add(rootNode);

      while (!q.isEmpty()){
          Vertex currentNode = (Vertex) q.peek();
          for (Vertex node : this.getAdjacentNodes(currentNode)){
              if (!node.visited){   
                  node.visited = true;
                  q.add(node);
                  visitedNodes++;
              }
          }
          q.remove();   
      }
      //reseting all flags
      for (Vertex node : nodes){
          node.visited = false;
      }

      return visitedNodes;
    
  }
  
  public boolean isConnected(){
      int numberOfNodes = nodes.size();
      
      for (Vertex node : nodes){
          if (!(this.breadthFirstSearch(node) == numberOfNodes)){
              return false;
          }
      }
      return true;
  }
  
  //TO-DO: error treatment. 
  // while this treatment doesn't exist: BE EXTREMELY CAREFUL WITH GRAPH.TXT
  // the right syntax is:
  //line (1) :1,2,...,n 
  //line (2) :1-2
  //line (3) : weight of the previous connection
  //line (n) :2-n
  //line (n+1) : weight of the previous connection
  //line (n+2) :-1
  //where the first line you must declare the nodes, each one separated by comma
  //the second til the n-th line you must declare the connections between the nodes declared 
  //in the first line
  //after every connection, in the next line, you must declare the weight of the connection
  // leave everything zero to create a unweighted graph
  //after the last connection, you must end with a -1
  // if you don't do this your computer may explode lol
  //...
  //...
  //...
  // i don't know, i did never try that.
  public void createGraph(String path) throws FileNotFoundException, IOException{
      this.path = path;
      
      nodes = new ArrayList<Vertex>();
      edges = new ArrayList<Edge>();
            
      FileReader fr = new FileReader(path);
      BufferedReader textReader = new BufferedReader(fr);
     
      //gets the first line, which are the nodes that must be created
      String TextData = textReader.readLine();
      
      //separate the string with numbers
      String[] nodesInString = TextData.split("\\s*,\\s*");
      
      //create the list of nodes
      for (String nodeInString : nodesInString){

          node = new Vertex(nodeInString, "node " + nodeInString);
          nodes.add(node);
          
      }
      
      //create the list of edges
      String edgeIntoString;
      Vertex vertex_aux1 = new Vertex("-1","-1");
      Vertex vertex_aux2 = new Vertex("-1","-1");;
      int n = 0;
      //varre a linha que tem x-y
      while (!(edgeIntoString = textReader.readLine()).equals("-1")){
          
          String[] nodesConnected = edgeIntoString.split("\\s*-\\s*");
          //varre os dois nodes
         
          int peso = Integer.parseInt(textReader.readLine());
              
              //verifica se x e y passados no txt estão instanciados em nodes 
              for (Vertex node : nodes){
         
                  if (nodesConnected[0].equals(node.getId())){
                      //se o node do txt foi achado em nodes
                      
                      vertex_aux1 = new Vertex(node.getId(), node.getName());
                  }
              }
              for (Vertex node : nodes){
         
                  if (nodesConnected[1].equals(node.getId())){
                     
                      
                      vertex_aux2 = new Vertex(node.getId(), node.getName());
                  }
              }
              
              
          edge = new Edge(Integer.toString(n),vertex_aux1, vertex_aux2, peso);
          edges.add(edge);
      }
      
      
      
  }
  // Add a new edge
  public boolean addEdge(Vertex source, Vertex destination) {
      Edge newEdge = new Edge("id", source, destination, 0);
      return this.edges.add(newEdge);
  }
  
  // Remove an edge
  public boolean removeEdge(Vertex source, Vertex destination) {
    
      Edge result = this.getEdge(source, destination);
      
      if (result != null) {
          return this.edges.remove(result);
      } else {
          System.out.println("Couldn't find edge");
          return false;
      }
  }
  
  public int getDegree(Vertex node){
      
      degree = 0;
      
      for (Vertex CurrentNode : nodes){
          if (hasEdge(node, CurrentNode)){
              degree++;
          }
      }
  
      return degree;
  }
  
  public void printGraph() {
   
      for (Vertex node: this.getNodes()){
          System.out.println(node.getName());
          System.out.print("Adjacent nodes: ");
          adjacentNodes = getAdjacentNodes(node);
          for (Vertex adjacentNode : adjacentNodes){
              System.out.print(adjacentNode.getName() + " ");
          }

          System.out.println(" ");
          System.out.println("Degree of this node: " + getDegree(node));
          System.out.println(" "); 
      }
      System.out.println("- - - - - - - - - - - - - - - - ");
      System.out.println(" ");
      System.out.println("Min Degree of this Graph: " + getMinDegree());
      System.out.println(" ");
      System.out.println("Max Degree of this Graph: " + getMaxDegree());
      System.out.println(" ");
      System.out.println("Average Degree of this Graph: " + getAvgDegree());
      System.out.println(" ");
      System.out.println("Graph is connected: " + this.isConnected());
      System.out.println(" ");
      System.out.println("- - - - - - - - - - - - - - - - ");
      System.out.println("Connections: ");
      System.out.println(" ");
      for (Edge edge : this.getEdges() ){
          System.out.print(edge.getSource().getId() +"<->"+edge.getDestination().getId()+" ");
          System.out.println("weight: " + edge.getWeight());
      }
      System.out.println(" ");
      System.out.println("- - - - - - - - - - - - - - - - ");
    }
  
  public void setAdjacencyMatrix() {
    
    initializeAdjacencyMatrix();
    int weigth;
    int source;
    int destination;
    for (Edge currentEdge : this.getEdges() ){
        weigth = currentEdge.getWeight();
        source = (int) nodesMatrixMap.get(currentEdge.getSource().getName());
        destination = (int) nodesMatrixMap.get(currentEdge.getDestination().getName());

        adjacencyMatrix[source][destination] = weigth; 
        //must be symmetric
        adjacencyMatrix[destination][source] = weigth; 
    }
  }
  
  public void initializeAdjacencyMatrix(){
      int numNodes = this.nodes.size();
      adjacencyMatrix = new int[numNodes][numNodes];
      nodesMatrixMap = new HashMap();
      for (int i = 0; i < numNodes; i++) {
          nodesMatrixMap.put(this.nodes.get(i).getName(), i);
          for (int j = 0; j < numNodes; j++) {
              adjacencyMatrix[i][j] = -1;
          }
      }
  }
  
  public void printAdjacencyMatrix() {
    
      String sourceName;
      String destName;
      int source;
      int dest;
      
      System.out.println(" ");
      System.out.println("Adjacency Matrix: ");
      System.out.println(" ");
      
      for (int i = 0; i < this.nodes.size(); i++) {
          sourceName = this.nodes.get(i).getName();
          source = (int) nodesMatrixMap.get(sourceName);
          for (int j = 0; j < this.nodes.size(); j++) {
              destName = this.nodes.get(j).getName();
              dest = (int) nodesMatrixMap.get(destName);
              if (adjacencyMatrix[source][dest] == -1) {
                  System.out.print("- ");
              } else {
                  System.out.print(adjacencyMatrix[source][dest] + " ");
              }
          }
          System.out.print("\n");
      }
  }
  
}

</code>
</pre>

&nbsp;

<h3>The test file</h3>

<p>Here’s the file containing the main, if you want to test, remember to change the path file!</p>

<pre>
<code class="java hljs">
package graphproject;
import GraphModels.*;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class GraphProject {
    
    //graph creation procedure
    private List<Vertex> nodes;
    private List<Edge> edges;
    private Graph graph;
    public Vertex node;
    public Edge edge;
    
    public void printGraph(Graph graph) {
      for (Vertex node: graph.getNodes()){
             System.out.println(node.toString());
      }
      
      for (Edge edge : graph.getEdges() ){
             System.out.println(edge.toString());
             System.out.println(" ");
      }
      
    }
    
    public void test() throws IOException{
        
        Graph graph = new Graph();
        graph.createGraph("/Users/daniel/Documents/workspace_java/GraphProject/src/graphproject/graph.txt");
        
        graph.printGraph();
        graph.setAdjacencyMatrix();
        graph.printAdjacencyMatrix();
    }
    //end of graph creation procedure
 
    public static void main(String[] args) throws IOException {
       GraphProject gp = new GraphProject();
       
       gp.test();
    }
}

</code>
</pre>
&nbsp;

<h2>Conclusion and next steps</h2>

<p>At this moment, you’re perfectly able to create a graph (via .txt file) and run all those algorithms to extract information about your graph. Just make sure to import the right libraries and to put the files in the right package. Doing these little things right, I’m pretty sure this will work perfectly.</p>

<p>But I’m sure you may be a little lost about a few algorithms and techniques we’ve implemented in the Graph.java. But, don’t worry, i’ll be explaining each method one by one in the next parts of this post!</p>

</html>


</p>
    </li>
    <hr/>
    &nbsp;
  
    <li>
	<h1>
      <a href="/2014/07/22/CRUD-with-Java,-JSP,-and-MySQL/">
	
	<div style="line-height:35px;color:#444;">CRUD with Java, JSP and MySQL</div>
	
	</a>
	</h1>
	<div style="margin-top:-15px;color:#E11F00;">22 July 2014</div>
        &nbsp;
      <p><p>One of the most common kind of applications in today's tech/business world is the CRUD system, that is the idea of the user interacting with a database, so the user can Create, Retrieve, Update and Delete <em>(yep, that awful name came from this)</em> data from this database. Also, <strong>learning how to create a CRUD with a language is a great way to understand the basics of this language, the basics of software design, engineering and architecture.</strong> In layman's term, a CRUD page is just a page where you can insert a thing, edit that thing, search that thing and delete that thing, just that!</p>
&nbsp;
<h3>Our goal</h3>
<p>Well, our scenario will be the simplest possible, so we can understand how to communicate with our database, so, it will be a simple contact book web app where we can do our CRUD with persons. This person will have <!--more--> a name, a phone number and a profession. We'll have a button to add a new person, a form to enter this new person's information, a page where will be loaded all persons from the database and buttons to edit and remove each person</p>
<div><img src="/images/smallcrudscreen-1024x300.png" width=700 height=200 /></div>
&nbsp;
&nbsp;
<h3>Our Technology Stack</h3>
<p>We'll be using Java as our backend technology, Java ServerPages(JSP) as our view technology and MySQL as our relational database. Also, we'll be using the MVC architecture, which is the idea of separating the code by <em><strong>M</strong>odel</em>, <em><strong>V</strong>iew</em> and <em><strong>C</strong>ontroller</em>, that's a whole other topic to study, you can take a look <a href="http://blog.codinghorror.com/understanding-model-view-controller/">here</a>, <a href="http://code.tutsplus.com/tutorials/mvc-for-noobs--net-10488">here</a> and <a href="http://www.bennadel.com/blog/2379-a-better-understanding-of-mvc-model-view-controller-thanks-to-steven-neiland.htm">here</a>!</p>
<p>For those who doesn't know JSP technology, I highly advice to study just a little bit of it before read this article, as this will be our main view technology, it's a great abstraction over the <a href="http://www.ntu.edu.sg/home/ehchua/programming/java/JavaServlets.html">Servlets</a> technology. It simply helps to process Java code on our pages <em>without putting pure java syntax in the middle of our HTML</em>, which would be extremely ugly and hard to maintain.</p>
&nbsp;
<h3>The Data Access Object (DAO) pattern</h3>
<p>The DAO pattern is a great way to abstract the communication with our database, simply put, the ObjectDAO is a class that will implement the CRUD methods of the Object. This way, our entity class, which is a Java class with only its attributes and their respective getters and setters, won't have to deal directly with the database, you can read more about the DAO pattern <a href="http://www.oracle.com/technetwork/java/dataaccessobject-138824.html">here</a>.</p>
&nbsp;
<h3>The JDBC</h3>
<p>This will be the driver that will abstract the connection with the database, it's pretty simple to use and it's the standard of the oracle, you can read more about it <a href="http://www.oracle.com/technetwork/java/overview-141217.html">here</a>.</p>
<p><strong>Finally, the final view of our scenario</strong></p>
<img src="/images/SmallCRUD1.png"width="642" height="362" />
<p>And, for any guidance, here's the <strong>project hierarchy</strong>:</p>
<img src="/images/smallcrudhierarchy.png" width="268" height="474" />
&nbsp;
<h3>Creating the Database</h3>
<p>Small and simple step, just create the MySQL scheme that we'll use on this project, that is, just a table person, with name, profession and phone. Here's the code:</p>
<pre>
<code class="sql hljs">
CREATE TABLE IF NOT EXISTS `smallcrud`.`person` (
  `idperson` INT(11) NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  `phone` VARCHAR(45) NOT NULL,
  `profession` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idperson`))
</code>
</pre>
&nbsp;
<h3>Creating the model</h3>
<p>We'll create the Person, which will be our Java Bean for Person.</p><pre>
<code class="java hljs">
package model;

public class Person {

    public Person() {

    }

    public String name;
    public String phone;
    public String profession;
    public int personId;

    public int getPersonId() {
        return personId;
    }

    public void setPersonId(int personId) {
        this.personId = personId;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getPhone() {
        return phone;
    }

    public void setPhone(String phone) {
        this.phone = phone;
    }

    public String getProfession() {
        return profession;
    }

    public void setProfession(String profession) {
        this.profession = profession;
    }
}
</code>
</pre>

<pre class="lang:java decode:true" title="Person.java" data-url="https://raw.githubusercontent.com/digorithm/SmallCRUD/master/src/java/model/Person.java"></pre>
<h3>Creating the connection class</h3>
<p>The connection class will be the responsible for the connection with the database, using the JDBC API, it's fair simple:</p>  

<pre>
<code class="java hljs">
package dao;

import java.sql.Statement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class ConnectionClass {

    public Connection getConnection()
            throws SQLException {
        DriverManager.registerDriver(new com.mysql.jdbc.Driver());
        return DriverManager.getConnection(
                "jdbc:mysql://localhost:3306/simplecrud", "root", "sa");

    }

}
</code>
</pre>

<p><em><strong>!important: </strong>These Strings "jdbc:mysql://localhost:3306/simplecrud", "root", "sa" depends on the configuration of the database that you created, the first one is the URI of the database, the second "root" is the user of that database, and the last "sa" is the password of that database</em></p>

<p>So, what happens when we use this class? Every time we call its method "getConnection" it returns a Connection with the database, that will be useful to create Statements, execute SQL Queries and plenty <a href="http://docs.oracle.com/javase/7/docs/api/java/sql/Connection.html">more</a>.</p>
&nbsp;
<h3>Creating the PersonDAO</h3>
<p>The PersonDAO will be the class that will manipulate the class Person and communicate with the database, sending persons to database, updating persons, retrieving persons from the DB, which means, the CRUD main methods</p
>
<pre>
<code class="java hljs">
package dao;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;

import model.Person;

public class PersonDAO {

    private Connection connection;

    public PersonDAO() {
        ConnectionClass con = new ConnectionClass();
        try {
            connection = con.getConnection();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public void addPerson(Person person) {
        try {
            String query = "insert into person(name, phone, profession) 
values ('" + person.getName() + "', '" + person.getPhone() + "', '" + person.getProfession() + "')";

            Statement stmt = connection.createStatement();
            stmt.executeUpdate(query);
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public void removePerson(int personid) {
        String query = "delete from person where person.idperson = " + personid + " ";
        try {
            Statement stmt = connection.createStatement();
            stmt.executeUpdate(query);
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public void updatePerson(Person person) {
        String query = "update person set person.name='" + person.getName() + "', person.phone='" + person.getPhone()
                + "', person.profession='" + person.getProfession() + "' where person.idperson = " + person.getPersonId() + " ";
        System.out.println(query);
        try {
            Statement stmt = connection.createStatement();
            stmt.executeUpdate(query);
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public ArrayList<Person> getPersons() throws SQLException {
        String query = "select * from person";
        ArrayList<Person> persons = new ArrayList<Person>();
        Statement stmt = connection.createStatement();
        ResultSet res = stmt.executeQuery(query);
        while (res.next()) {
            Person person = new Person();
            person.setName(res.getString("name"));
            person.setPhone(res.getString("phone"));
            person.setProfession(res.getString("profession"));
            person.setPersonId(res.getInt("idperson"));
            persons.add(person);
        }
        return persons;
    }

    public Person getPersonById(int personid) throws SQLException {
        Person person = new Person();
        String query = "select * from person where person.idperson = " + personid + " ";
        Statement stmt = connection.createStatement();
        ResultSet res = stmt.executeQuery(query);
        if (res.next()) {
            person.setName(res.getString("name"));
            person.setPhone(res.getString("phone"));
            person.setProfession(res.getString("profession"));
            person.setPersonId(res.getInt("idperson"));
        }
        return person;
    }
}
</code>
</pre>
&nbsp;
<h3>Creating the Controller</h3>

<p>This is the most confusing part. All because of the confusion of <strong>not</strong> using JSP file to process the request, so what we will use? <strong>Servlets! </strong> A Servlet fits better in the Controller role, because they won't show anything to the user, it will only get the request data, verify which action the user is trying to make, do something and redirect the user to another page. If you're using JSP files as controllers, probably you're <a href="http://www.geekinterview.com/question_details/37537">doing it wrong</a>. So, basically, our PersonController will take the user request, see if the user is trying to edit, insert, update, remove or retrieve... and do the right thing, pay extremely attention to this code</p>
<pre>
<code class="java hljs">
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package controller;

import dao.PersonDAO;
import java.io.IOException;
import java.io.PrintWriter;
import java.sql.SQLException;
import java.util.ArrayList;
import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import model.Person;

/**
 *
 * @author rodrigo
 */
@WebServlet(name = "PersonController", urlPatterns = {"/PersonController"})
public class PersonController extends HttpServlet {

    private static final long serialVersionUID = 1L;
    private static String insert_or_edit = "/Person.jsp";
    private static String list_person = "/ListPerson.jsp";
    private PersonDAO persondao;

    public PersonController() {
        super();
        persondao = new PersonDAO();
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String forward = "";
        String action = request.getParameter("action");
        if (action.equalsIgnoreCase("delete")) {
                        // the other page is sending the person id, so we can get here and
            // call the remove method
            int personid = Integer.parseInt(request.getParameter("personId"));
            // we remove the person from the database
            persondao.removePerson(personid);
                        // set the forward string to list and put all persons in request
            // attribute so we can use them inside the other page
            forward = list_person;
            try {
                request.setAttribute("persons", persondao.getPersons());
            } catch (SQLException e) {
                e.printStackTrace();
            }
            // if the user is trying to edit a person
        } else if (action.equalsIgnoreCase("edit")) {

            forward = insert_or_edit;
            int personid = Integer.parseInt(request.getParameter("personId"));
            try {
                Person person = persondao.getPersonById(personid);
                request.setAttribute("person", person);
            } catch (SQLException e) {
                e.printStackTrace();
            }

        } else if (action.equalsIgnoreCase("listPerson")) {
            forward = list_person;
            try {
                request.setAttribute("persons", persondao.getPersons());
            } catch (SQLException e) {
                e.printStackTrace();
            }
        } else {
            forward = insert_or_edit;
        }
        RequestDispatcher view = request.getRequestDispatcher(forward);
        view.forward(request, response);
    }

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        Person person = new Person();
        person.setName(request.getParameter("name"));
        person.setPhone(request.getParameter("phone"));
        person.setProfession(request.getParameter("profession"));        
        String personid = request.getParameter("personId");
         System.out.println("ola");
        System.out.println(personid);
                // what i'm trying to mean here is: if the personid coming from the
        // request is null
        // then, the user is trying to add someone, otherwise, he's trying to
        // update someone
        if (personid == null || personid.isEmpty()) {
            persondao.addPerson(person);
        } else {
            person.setPersonId(Integer.parseInt(personid));
            persondao.updatePerson(person);
        }

        response.sendRedirect(request.getContextPath() + "/index.jsp");
    }

}
</code>
</pre>
<h3>Creating the View: Index.jsp</h3>

<p>The index will be pretty simple and straight forward, it will just call our controller, passing the action by the get method, in this case, the ListPerson, the Controller will see that the action required is the ListPerson so it will do what it has to do, get all users from the database and list'em.</p>

<pre>
<code class="html hljs">
<%@ page language="java" contentType="text/html; charset=UTF-8"
         pageEncoding="UTF-8"%>
&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
        &lt;title>gt;Insert title here&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;jsp:forward page="/PersonController?action=listperson" /&gt;
    &lt;/body&gt;
&lt;/html&gt;

</code>
</pre>

<h3>Creating the View: ListPerson.jsp</h3>

<p>The controller got the action coming from the index and tried to retrieve every person in the database and put all person objects in the session, if there is any Person in the DB, of course. Here is the code to do it, as you can see we're already using the JSP tags to not use pure Java Scriplets</p>

<pre>
<code class="html hljs">
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<!doctype html>

&lt;html lang="en">
&lt;head>
                
&lt;meta charset="utf-8">
&lt;meta http-equiv="X-UA-Compatible" content="IE=edge">
&lt;meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport">
&lt;title>Test page&lt;/title>

&lt;link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
&lt;link href="http://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
&lt;link href="bootstrap.css" rel="stylesheet">
&lt;/head>
        &lt;body>
        
        &lt;div class="wrap">
        &lt;section>
            &lt;div class="container">
                    &lt;table class="table table-hover">
                            &lt;thead>
                                    &lt;tr>
                                            &lt;th>
                                                    #
                                            &lt;/th>
                                            &lt;th>
                                                    Name
                                            &lt;/th>
                                            &lt;th>
                                                    Phone Number
                                            &lt;/th>
                                            &lt;th>
                                                    Profession
                                            &lt;/th>
                                    &lt;/tr>
                            &lt;/thead>
                            &lt;tbody>
                                    &lt;c:forEach items="${persons}" var="person">
                                            &lt;tr>
                                                    &lt;td>
                                                            &lt;c:out value="${person.personId}"/>
                                                    &lt;/td>
                                                    &lt;td>
                                                            &lt;c:out value="${person.name}"/>
                                                    &lt;/td>
                                                    &lt;td>
                                                            &lt;c:out value="${person.phone}"/>
                                                    &lt;/td>
                                                    &lt;td>
                                                            &lt;c:out value="${person.profession}"/>
                                                    &lt;/td>
                                                    &lt;td>&lt;a href="PersonController?action=edit&personId=<lt;c:out value="${person.personId}"/>">Update&lt;/a>&lt;/td>
                                                    &lt;td>&lt;a href="PersonController?action=delete&personId=<lt;c:out value="${person.personId}"/>">Delete&lt;/a>&lt;/td>
                                            &lt;/tr>
                                    &lt;/c:forEach>
                            &lt;/tbody>
                    &lt;/table>
            &lt;a href="PersonController?action=insert" role="button" class="btn btn-info btn-lg" data-toggle="modal">Add new person&lt;/a>   
            &lt;/div>
        &lt;/section>      
&lt;/div>

&lt;script src="https://code.jquery.com/jquery-1.10.2.min.js">&lt;/script>
&lt;script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js">&lt;/script>

&lt;/body>
&lt;/html>
</code>
</pre>

<h3>Creating the View: Person.jsp</h3>
<p>This will be the page that the user will be able to insert or edit a Person in the database so it can be loaded on the ListUser.jsp. As the Controller says, if the request has an ID, the Person.jsp will be loaded with a Person, otherwise, it won't. (<em>expecting that the user fill the form to add a new Person to the database</em>)</p>

<a href="http://www.universocomputacao.com/wp-content/uploads/2014/07/smallcrudscreen2.png"><img class="aligncenter wp-image-74 size-medium" src="http://www.universocomputacao.com/wp-content/uploads/2014/07/smallcrudscreen2-300x263.png" alt="smallcrudscreen2" width="300" height="263" /></a>

<pre>
<code class="html hljs">

<%@ page language="java" contentType="text/html; charset=UTF-8"
         pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
&lt;html>
    &lt;head>
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        &lt;title>Insert title here<lt;/title>
        &lt;link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
        &lt;link href="http://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
        &lt;link href="Resource/bootstrap.css" rel="stylesheet">
    &lt;/head>
    &lt;body>
        &lt;div class="container">
            &lt;form method="POST" action='PersonController' name="frmAddPerson" role="form">
                 
                
                &lt;div class="form-group">
                    &lt;label for="personid">
                        id: &lt;input class="form-control" type="number" id="personId" name="personId" readonly value=<lt;c:out value="${person.personId}" /> />
                    &lt;/label>
                &lt;/div>
                &lt;div class="form-group">
                    &lt;label for="name">
                        Name:&lt;input class="form-control" type="text" id="name" name="name" value="&lt;c:out value="${person.name}" />" />
                    &lt;/label>
                &lt;/div>
                &lt;div class="form-group">
                    &lt;label for="phone">
                        Phone: &lt;input class="form-control" type="text" name="phone" value="&lt;c:out value="${person.phone}" />" /> 
                    &lt;/label>
                &lt;/div>
                &lt;div class="form-group">
                    &lt;label for="profession">
                        Profession: &lt;input class="form-control" type="text" name="profession" value="&lt;c:out value="${person.profession}" />" />
                    &lt;/label>
                &lt;/div>
                &lt;input type="submit" value="Submit" class="btn btn-info" />
            &lt;/form>
        &lt;/div>
        &lt;script src="https://code.jquery.com/jquery-1.10.2.min.js"><lt;/script>
        &lt;script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"><lt;/script>
    &lt;/body>
&lt;/html>

</code>
</pre>

<h3>Last details and conclusion</h3>
<p>As you can see, at the first sight this implementation can be a little confusing, mainly because of the flow logic and the controller built with Servlet, understanding the flow means understanding it as a whole. Make sure you understand the MVC logic and the concepts behind JSP, Servlets and JDBC.</p>

<p>If you're trying to copy the whole code, make sure you import the right libs, including the JSTL, responsible for a few tags I've used in this code. Also i used the Twitter's Bootstrap to help me with the frontend UI.</p>

<p>You can download the code here on my <a href="https://github.com/digorithm/SmallCRUD">GitHub</a></p>

<p>If there's something wrong with your implementation, please let me know, drop me an email or post a comment here and I'll make sure it will work properly! :]</p>

</p>
    </li>
    <hr/>
    &nbsp;
  
    <li>
	<h1>
      <a href="/2014/07/16/Object-Oriented-Thinking/">
	
	<div style="line-height:35px;color:#444;">Object Oriented Thinking</div>
	
	</a>
	</h1>
	<div style="margin-top:-15px;color:#E11F00;">16 July 2014</div>
        &nbsp;
      <p><html>
<p>
<strong>Before we start, which are the main goals of the object-oriented programming?</strong></p>

<p><em>1. Abstraction, yes, i had to put this in the first place, in my point of view, this is the biggest goal of the OO programming</em></p>

<p>2. Encapsulation, which is a form of abstraction!</p>

<p>3. Reusability</p>

<p>4. Modularity</p>

<p>5. Readability</p>

<p>Let’s say that OO programming did <strong>never</strong> exist, so, i can say that any procedural programmer <em>(C, fortran, cobol, etc..)</em> who has a little notion about how to build organized codes, would, naturally, evolve to an organization that would look like the actual concept of OO programming.</p>

<p>Don’t you think? It would be intuitive, the object-oriented thinking is a quite natural way to think, let me show you… We are used to separate <em>things</em> (from now we’ll call thing as objects) by it’s <em>class</em>, just like the class “Car”, we know GM, wolksvagem, nissan, honda…but they all are cars, right? And we’re also used to say that something <em>inherited</em> some particularities from his precedent… And that’s the idea behind the OO programming, grab the main concept of object and class that defines objects in <strong>real world</strong> and use it on programming!</p>

<img src="/images/dog.gif">
<p>

Just before the creation of Object-Oriented Programming, the system development in C was using the concept of breaking the big problem into small sub-problems, where each sub-result together would generate the solution of the big problem in question. It’s actually smart to think like this, the OOP languages just formalized this concept (and of course, create others features, but this was the start point). Look at this following problem: We want a data structure to represent the functionaries of determined business, this functionary should have a name, age, salary and a function to change his salary. Let’s deal with it in the smartest way, which is, creating separately some structure that will represent the functionaries, in C we would code something like this:
</p>



<pre>
<code class="c hljs">
typedef struct functionary{
  int age;
  char name[50];
  float salary;
}stru_func, *ap_func;

void riseSalary(ap_func pthis){ 
      int n;
      printf("Enter new salary: \n");
      scanf("%d", n);
      pthis->salary = n;
  }
</code>
</pre>

<p>As you can see, in this func.c, we have the structure to represent the functionaries and the function that we will use. (from now, we’ll call function as METHODS)</p>

<p>And here’s the <strong>main code:</strong></p>

<pre>
<code class="c hljs">
#include "func.c"
int main(){
  stru_func new;
  printf("Enter the age, name and salary: \n");
  scanf("%d", &amp;new.age);
  scanf("%s", &amp;new.name);
  scanf("%f", &amp;new.salary);
  printf ("%d \n", new.age);
  printf ("%s \n", new.name);
  printf ("%f \n", new.salary);
  riseSalary(&amp;new);
  printf("%f", new.salary);
  return 0;
}
</code>
</pre>

<p>Done, now we have a nice example of class and object…but, made with C! Where the class is this struct called “functionary” and the variables inside it we call “attributes” and the function “riseSalary” we call “method” (obs: look that the function/method is OUTSIDE the struct functionary), in fact we separate the module that represent the functionaries from the main module, and if we want, we can use this functionary module in other problems that need a struct to represent functionaries with those attributes/methods!</p>

<p>And…where’s the object? Right there in the main module, where we created a “variable” called “new” from the struct functionary, this is called “INSTANCE”, in this moment, we create a object from its class! Again, the class is the structure that represent the functionary and the object is the “variable” that we created with this structure!</p>

<p>All these concepts already happened before the creation of the pure Object-Oriented languages, but there was a need of formalize these techniques, creating more rigorous, useful and trustful standards.</p>

<p>The same problem that we solved in C, in java, would be something like this:</p>

<pre>
<code class="java hljs">
public class functionary
{
  public int age;
  public string name;
  public int salary;
  public void riseSalary(int n)
  {
      this.salary = n;
  }
}
</code>
</pre>

<p>As you should have noticed, the method now is INSIDE the structure that represent the functionary (the class).
And what the big advantage of this? the class is now more portable, we can reuse it easily!</p>
<p>in the main module we could just create as many object as we want just using:
<em>“functionary func = new functionary();”</em></p>

<p><strong>Conclusion</strong>: Of course that the big evolution of procedural to Object-Oriented did not stop there! The concept of reuse, organize and divide the code and the problem created others many famous techniques that we can use on classes and objects, like the <strong>polymorfism</strong>, inheritance, abstract class and many others! But this evolution kept one main goal: <strong>modularity with more abstraction.</strong></p>

</html>
</p>
    </li>
    <hr/>
    &nbsp;
  
  &nbsp;
  &nbsp;
  &nbsp;
        <div style="width:95%;display:block-inline;font-size:20px; margin-left:12px;">
                

                <div style="font-family:'proregular';float:left;"><a href="/blog/"> Recent Posts </a></div>
                
                

                <div style="font-family:'proregular';float:right;"><a href="/blog/page3/">Older Posts -></a></div>
                


        </div>
</ul>


  </div>


<!-- InstanceEndEditable --><!-- InstanceBeginEditable name="subNav" --><!-- InstanceEndEditable --><!-- InstanceBeginEditable name="mainContent" --><!-- InstanceEndEditable -->
  <!-- This clearing element should immediately follow the #mainContent div in order to force the #container div to contain all child floats -->
  <br class="clearfloat" />
  <!-- InstanceBeginEditable name="footer" -->
  <div id="footer">
    <!-- end #footer -->
    </div>
  <!-- InstanceEndEditable -->
  <!-- end #container --></div>
    

</body>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script>


var fixmeTop = $('#sidebar').offset().top;       // get initial position of the element

$(window).scroll(function() {                  // assign scroll event listener

    var currentScroll = $(window).scrollTop(); // get current position

    if (currentScroll + 20 >= fixmeTop) {           // apply position: fixed if you
        $('#sidebar').css({                      // scroll to that element or below it
            position: 'fixed',
            top: '0',
	    'margin-top':'0px',
            'left': '200'
        });
    } else {                                   // apply position: static
        $('#sidebar').css({                      // if you scroll above it
            position: 'static',
            'margin-top': '0px',
            'left':'200px'
        });
    }

});


$(document).ready(function(){
    // to fade in on page load
   $("#mainContent").fadeIn(1500).removeClass("hidden");
   $('a').click(function(e){
        redirect = $(this).attr('href');
        e.preventDefault();
        $('#mainContent').fadeOut(500, function(){
            document.location.href = redirect
        });
    });
})

</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38327934-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- InstanceEnd --></html>
