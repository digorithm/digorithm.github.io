I"Ý+<p>Are you total lost in this world full of jargons like: API, Rest API, microservices and stuffs? Come here, sit, grab a cup of coffee, and letâ€™s talk briefly about it.</p>

<p>Today a lot is said about APIs. Everything has an API, every programmer (newbie to expert) uses tons of API. Also, today we can see a lot of people talking about microservices and the idea of total separation of backend, frontend, web services or <em>whatever</em>. So we can <em>(and we do)</em> hear a lot about REST/RESTful APIs. We have 3 current problems with it:</p>

<!--more-->

<p>1. Many new programmers donâ€™t have a single clue of what a Rest API is.</p>

<p>2. Itâ€™s probable that theyâ€™re using Rest APIs and donâ€™t know about it.</p>

<p>3. When they feel that they should learn more about it, thereâ€™s hardly any good and accessible material to learn it.</p>

<h3 id="so-heres-a-extremely-simplistic-approach-to-try-to-explain-what-is-a-rest-api">So hereâ€™s a extremely simplistic approach to try to explain what is a Rest API</h3>

<p>Starting with the concept of API, which stands for <strong>A</strong>pplication <strong>P</strong>rogramming <strong>I</strong>nterface, itâ€™s just an interface which you, <em>dear programmer</em>, will be dealing with to extract whatever you <em>(or your program)</em> want.</p>

<p>Suppose your program needs to create a connection with a given database, normally you do:</p>

<p>1. You import the <em>library</em> that will abstract the connection with the database</p>

<p>2. You create an object to represent a Connection with the database</p>

<p>3. You call functions that this object provide to you, so you can do whatever you want (and whatever they provide)</p>

<p>Hereâ€™s a silly example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from database_library import Connection

connection = Connection()
connection.OpenConnection()
â€¦ do whatever you want
connection.CloseConnection()
</code></pre></div></div>

<p>When you called those function, you were dealing with the interface that the object provided to you, sure the object may be doing thousand of things at the moment you call its functions, but, it doesnâ€™t matter to you, does it? You just want the <em>damn</em> connection open and then closed.</p>

<p>So the library that you imported is giving you something you want, offering a service or a resource. Thatâ€™s the sole purpose of an API. Itâ€™s a layer that you can use to get things from other(s) component(s).</p>

<p>So, itâ€™s easy to deduct that, the better the engineer planned the API, the easier it will be to deal with and extract what you want, and the contrary is true.</p>

<p>But still, youâ€™re processing the core of this API in your own machine, which isnâ€™t that great, hereâ€™s when the API evolves to whole web hosted services, so you can request this API something, and this API can give you something, through the WEB, via HTTP request. And thatâ€™s amazing.</p>

<p>And the community, recently, decided that the request and response that happen between applications and APIs, should be done with JSON, so this communication can become uniform and APIs can talk to other APIs effortlessly.</p>

<p>So, basically, whatâ€™s going on is:</p>

<p><img src="/content/images/2015/06/json-rest3.png" alt="" /></p>

<p>Soâ€¦ yes, you make your function calls, now, with just a simple URL + HTTP methods, wanna see a real example? We can just send a request to the Facebookâ€™s API by accessing this URL: <a href="http://graph.facebook.com/contatodigo">http://graph.facebook.com/contatodigo</a></p>

<p>Which will request my profileâ€™s data, and the Facebookâ€™s API will return:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
   "id": "100001638888259",
   "first_name": "Rodrigo",
   "gender": "male",
   "last_name": "Ara\u00fajo",
   "link": "https://www.facebook.com/contatodigo",
   "locale": "pt_BR",
   "name": "Rodrigo Ara\u00fajo",
   "username": "contatodigo"
}
</code></pre></div></div>

<p>As simple as that.</p>

<p>Now with this basic idea explained, we can do a simple Rest API using Python and Flask. (Iâ€™m assuming youâ€™re already familiar with both technologies).</p>

<p>All weâ€™re gonna do is, using the flask routing, create routes to the users so they can interact with the resources of our API. Letâ€™s suppose our API will serve and receive only Books. So this is the resource weâ€™re dealing with, users may use our API to get Books and insert new Books, so our only URIs will be:</p>

<p>1. <em>/bookapi/v1.0/books</em> with a GET method, which will just return the list of books</p>

<p>2. <em>/bookapi/v1.0/books</em> with a POST method, which will insert a book</p>

<p>So after the API is built, you or you program can get books or insert books by sending HTTP request to the APIâ€™s URIs, simple as that. Iâ€™ll be very straight forward, hereâ€™s the code:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!flask/bin/python
</span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">books</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s">'id'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'title'</span><span class="p">:</span> <span class="s">u'Game of Thrones'</span><span class="p">,</span>
        <span class="s">'description'</span><span class="p">:</span> <span class="s">u'Cool dragons'</span><span class="p">,</span> 
        <span class="s">'finished'</span><span class="p">:</span> <span class="bp">False</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s">'id'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s">'title'</span><span class="p">:</span> <span class="s">u'50 shadows of grey'</span><span class="p">,</span>
        <span class="s">'description'</span><span class="p">:</span> <span class="s">u'It start as bullshit, end as a huge bullshit'</span><span class="p">,</span> 
        <span class="s">'finished'</span><span class="p">:</span> <span class="bp">True</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="o">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/bookapi/v1.0/books/'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'GET'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_books</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">'books'</span><span class="p">:</span> <span class="n">books</span><span class="p">})</span>

<span class="o">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/bookapi/v1.0/books'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'POST'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">create_book</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span> <span class="ow">or</span> <span class="ow">not</span> <span class="s">'title'</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">:</span>
        <span class="n">abort</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>

    <span class="n">book</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'id'</span><span class="p">:</span> <span class="n">books</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s">'id'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s">'title'</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">[</span><span class="s">'title'</span><span class="p">],</span>
            <span class="s">'description'</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'description'</span><span class="p">,</span> <span class="s">""</span><span class="p">),</span>
            <span class="s">'finished'</span><span class="p">:</span> <span class="bp">False</span>
            <span class="p">}</span>

    <span class="n">books</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">'book'</span><span class="p">:</span> <span class="n">book</span><span class="p">}),</span> <span class="mi">201</span> 

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>Note that weâ€™re creating a simple in-memory <em>database</em>, which is a simple pythonâ€™s dict. This could be a database. But for the sake of simplicity, Iâ€™m using just a dict.</p>

<p>When the requests come, it verifies the route that the user is asking for, which is: what resources is he/she wanting? and then, the code do whatever it must do (<em>remember the API idea of hiding the complexity, the user requesting just want the result</em>), and then it put everything in a JSON and returns it. That simple!</p>

<p>Of course, many improvements and extensions (<em>there are infinity possibilities</em>) can be made to this code, but, hereâ€™s a skeleton of the idea of an API, itâ€™s just a start. One good practice itâ€™s to <em>not</em> return the ID of the resource, but return just its URI, which is surely a great idea. Another good practice is to ask authentication in every HTTP request, so your API wonâ€™t be exposed to everybody. There are, indeed, endless improvements, but in this code, you, that are completely beginner to the APIâ€™s concept, can now understand whatâ€™s going on underneath and start planning and building your own API using Flask.</p>
:ET